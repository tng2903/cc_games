window.__require=function t(e,i,n){function o(a,c){if(!i[a]){if(!e[a]){var r=a.split("/");if(r=r[r.length-1],!e[r]){var h="function"==typeof __require&&__require;if(!c&&h)return h(r,!0);if(s)return s(r,!0);throw new Error("Cannot find module '"+a+"'")}a=r}var l=i[a]={exports:{}};e[a][0].call(l.exports,function(t){return o(e[a][1][t]||t)},l,l.exports,t,e,i,n)}return i[a].exports}for(var s="function"==typeof __require&&__require,a=0;a<n.length;a++)o(n[a]);return o}({aiFactory:[function(t,e){"use strict";cc._RF.push(e,"913ddnI6FlOh7ms0UF7K/NU","aiFactory"),cc.Class({extends:cc.Component,properties:{ai0Pre:{default:null,type:cc.Prefab},ai3Pre:{default:null,type:cc.Prefab},ai4Pre:{default:null,type:cc.Prefab},ai5Pre:{default:null,type:cc.Prefab},ai6Pre:{default:null,type:cc.Prefab},magic1Pre:{default:null,type:cc.Prefab},w:{default:null,type:cc.Node},scoreCtl:{default:null,type:cc.Node},validWidth:0,validCount:0,initY:0,aiSize:60},onLoad:function(){this.validWidth=this.w.width-20,this.validCount=parseInt(this.validWidth/this.aiSize)},start:function(){},startRound:function(t,e,i,n){if(t){var o=this.initY;this.initY=this.initY+180,this.createAis(e,i,!0),this.initY=this.initY-60,this.createAis(e,i,!0),this.initY=this.initY-60,this.createAis(e,i,!0),this.initY=o}else this.createAis(e,i,n)},createAis:function(t,e,i){var n=this.getAiReady(t,i),o=n;i&&n--;for(var s=this.getScoreReady(t,e),a=this.validWidth,c=0,r=0,h=0,l=!1,u=0;u<o;u++){var d=this.getInitX(a-(o-u-1)*this.aiSize);if(c+=d,i&&0==h&&(Math.random()>.5?l=!0:o-1==u&&(l=!0)),l)l=!1,h++,(f=cc.instantiate(this.magic1Pre)).y=this.initY,f.x=c+this.w.x+10-this.w.width/2,this.node.addChild(f);else{var f;r++,(f=cc.instantiate(this.randAiType())).getComponent("ai").scoreCtl=this.scoreCtl,f.y=this.initY,f.x=c+this.w.x+10-this.w.width/2;var g=0;r==n?g=s:s-=g=parseInt((s-(n-r)-1)*Math.random()+1),f.getComponent("ai").initAi(g),this.node.addChild(f)}c+=this.aiSize/2,a=a-d-this.aiSize/2}},getInitX:function(t){return t<this.aiSize?null:this.aiSize/2+Math.random()*(t-this.aiSize)},randAiType:function(){var t=5*Math.random();return t<1?this.ai0Pre:t<2?this.ai3Pre:t<3?this.ai4Pre:t<4?this.ai5Pre:this.ai6Pre},getScoreReady:function(t,e){var i=0;return 59>=t?(i=(2+t/60*10)*t,i*=.8+.4*Math.random()):i=700+299*Math.random(),e||(i*=.2+.2*Math.random()),(i=parseInt(i))<6&&(i=6),i},getAiReady:function(t,e){if(t<45){console.log("cc",cc);var i=Math.random();return console.log("Math.random()",i),i<.3?e?2:1:i<.6?2:i<.9?3:i<.95?4:5}return(i=Math.random())<.2?e?2:1:i<.4?2:i<.6?3:i<.8?4:5}}),cc._RF.pop()},{}],ai:[function(t,e){"use strict";cc._RF.push(e,"2b7b0nNCtVJ25fqXxkII4H1","ai"),cc.Class({extends:cc.Component,properties:{scoreShow:{default:null,type:cc.Label},scoreCtl:{default:null,type:cc.Node},shakeCountSet:8,shakeSizeSet:3,initx:0,inity:0,isShaking:!1,shakeCount:0,moveDis:60,score:0,needReset:!1},start:function(){},update:function(){this.isShaking&&(this.shakeCount--,this.shake(),0==this.shakeCount&&(this.isShaking=!1,this.needReset=!0)),!this.isShaking&&this.needReset&&(this.node.x=this.initx,this.node.y=this.inity,this.needReset=!1)},onBeginContact:function(t,e,i){this.cutScore(),this.shakeStart(),i.body.gravityScale=3,this.scoreCtl.getComponent("scoreCtl").addScore()},shakeStart:function(){this.isShaking||(this.initx=this.node.x,this.inity=this.node.y),this.isShaking=!0,this.shakeCount=this.shakeCountSet},shake:function(){var t=6.29*(2*Math.random()-1),e=Math.sin(t)*this.shakeSizeSet,i=Math.cos(t)*this.shakeSizeSet;this.node.x=this.initx+e,this.node.y=this.inity+i},moveUp:function(){var t=cc.moveTo(.5,this.node.x,this.node.y+this.moveDis);this.node.runAction(t)},initAi:function(t){this.score=t,this.scoreShow.string=this.score;var e=360*Math.random();this.node.rotation=e,this.scoreShow.node.rotation=-e,this.initColor()},cutScore:function(){this.score--,0!=this.score?this.scoreShow.string=this.score:this.node.destroy()},initColor:function(){var t=6*Math.random();this.node.color=t<1?new cc.Color(36,229,209):t<2?new cc.Color(114,149,252):t<3?new cc.Color(0,241,68):t<4?new cc.Color(183,3,222):t<5?new cc.Color(255,221,32):new cc.Color(245,20,163)}}),cc._RF.pop()},{}],flag:[function(t,e){"use strict";cc._RF.push(e,"33f73o9GJ1N16X31jDqq8kY","flag"),cc.Class({extends:cc.Component,properties:{type:"",out:!1},start:function(){},isGameOver:function(t){return"ai"!=this.type||this.out?0:this.node.y+this.node.height>=t?2:this.node.y+this.node.height+60>=t?1:0}}),cc._RF.pop()},{}],gameCtl:[function(t,e){"use strict";cc._RF.push(e,"696b6xP8sNOO7wrjFDicRi8","gameCtl"),cc.Class({extends:cc.Component,properties:{ballPre:{default:null,type:cc.Prefab},balls:{default:null,type:cc.Node},ff:{default:null,type:cc.Node},supLine:{default:null,type:cc.Node},aiFac:{default:null,type:cc.Node},ballsShow:{default:null,type:cc.Label},ball_move:{default:null,type:cc.Prefab},scoreCtl:{default:null,type:cc.Node},resultCtl:{default:null,type:cc.Node},roundReady:!1,shootPower:0,roundNum:0,roundBalls:0,roundBallsReal:0,readyCount:0,shootClock:null,gameHeight:0,needBofeng:!0,bofengRoundLimit:3,bofengRoundTemp:0,magicRoundTemp:0,deadLine:0,isStoping:!0},onLoad:function(){this.gameHeight=document.body.clientHeight/document.body.clientWidth*450,this.deadLine=this.ff.y-this.ff.height-60,cc.director.getPhysicsManager().enabled=!0,this.initPlayerEvent(),this.ballsShow.string="0",this.roundReady=!1,this.roundNum=0,this.roundBalls=0,this.needBofeng=!0,this.roundBallsReal=0,this.readyCount=0,this.bofengRoundTemp=0,this.magicRoundTemp=0,this.isStoping=!0,this.supLine.active=!1},start:function(){},startGame:function(){var t=this.aiFac.children;for(var e in t)t[e].getComponent("flag").out=!0,t[e].destroy();for(var i in t=this.balls.children)t[i].destroy();this.ballsShow.string="0",this.roundReady=!1,this.roundNum=0,this.roundBalls=0,this.needBofeng=!0,this.roundBallsReal=0,this.readyCount=0,this.bofengRoundTemp=0,this.magicRoundTemp=0,this.isStoping=!1,this.initGame(),this.roundNextReady(!0),this.resultCtl.getComponent("resultCtl").startGame()},initGame:function(){this.scoreCtl.getComponent("scoreCtl").initScore(),this.magicRoundTemp=-1,this.roundNum=0,this.bofengRoundTemp=0,this.roundBalls=1,this.ballsShow.string=this.roundBalls,this.roundBallsReal=0,this.readyCount=0},initPlayerEvent:function(){var t=this;this.node.on("touchstart",function(e){t.roundReady&&!t.isStoping&&(t.initFF(e),t.supLine.active=!0)}),this.node.on("touchmove",function(e){t.roundReady&&!t.isStoping&&(t.initFF(e),t.supLine.active=!0)}),this.node.on("touchend",function(){t.roundReady&&!t.isStoping&&(t.supLine.active=!1,t.startRound())})},createBalls:function(t,e,i,n){var o=cc.instantiate(this.ballPre);o.x=i,o.y=n,o.getComponent("magic").pool=this.balls,o.getComponent("magic").gameCtl=this.node,o.getComponent(cc.RigidBody).linearVelocity=cc.v2(t,e),this.balls.addChild(o)},initFF:function(t){var e=this.ff.x-(t.getLocationX()-225),i=this.ff.y-(t.getLocationY()-this.gameHeight/2);if(i<=0)this.ff.rotation=e>0?85:-85;else{var n=360*Math.atan(e/i)/(2*Math.PI);(-85>n||85<n)&&(n=e>0?85:-85),this.ff.rotation=n}},moveBall:function(t,e){var i=cc.instantiate(this.ball_move);i.x=t,i.y=e,this.node.addChild(i);var n=cc.moveTo(.3,t,e+1e3),o=this;setTimeout(function(){i.destroy(),o.readyCount++,o.readyCount==o.roundBalls&&o.roundNextReady()},300),i.runAction(n)},startRound:function(){this.roundReady=!1;var t=-Math.sin(this.ff.rotation*Math.PI/180)*this.shootPower,e=-Math.cos(this.ff.rotation*Math.PI/180)*this.shootPower,i=this.ff.x-Math.sin(this.ff.rotation*Math.PI/180)*this.ff.height,n=this.ff.y-Math.cos(this.ff.rotation*Math.PI/180)*this.ff.height,o=this;clearInterval(o.shootClock),this.shootClock=setInterval(function(){o.roundBallsReal<o.roundBalls?(o.createBalls(t,e,i,n),o.roundBallsReal++,o.ballsShow.string=o.roundBalls-o.roundBallsReal):clearInterval(o.shootClock)},200)},addBallNum:function(){this.roundBalls++,this.roundBallsReal++,this.needBofeng=!0},roundNextReady:function(t){this.roundNum++,this.roundBallsReal=0,this.readyCount=0,this.needBofeng?this.bofengRoundTemp=0:this.bofengRoundTemp++,this.bofengRoundTemp>this.bofengRoundLimit&&(this.needBofeng=!0),this.aiFac.getComponent("aiFactory").startRound(t,this.roundBalls,this.needBofeng,this.getMagicReady()),1!=this.roundNum&&this.moveAi();var e=this.isGameOver();if("ok"==e){this.needBofeng=!1;var i=this;setTimeout(function(){i.ballsShow.string=i.roundBalls,i.roundReady=!0},500)}else"warning"==e?(this.resultCtl.getComponent("resultCtl").showWarninig(),i=this,setTimeout(function(){i.needBofeng=!1,i.ballsShow.string=i.roundBalls,i.roundReady=!0},1500)):"gameover"==e&&(i=this,setTimeout(function(){i.resultCtl.getComponent("resultCtl").gameOver(i.scoreCtl.getComponent("scoreCtl").score)},500))},moveAi:function(){var t=this.aiFac.children;for(var e in t){var i=cc.moveTo(.5,t[e].x,t[e].y+60);t[e].runAction(i)}},getMagicReady:function(){if(this.roundBalls<=45){if(this.magicRoundTemp>=1)return this.magicRoundTemp=0,!0}else if(this.magicRoundTemp>=2)return this.magicRoundTemp=0,!0;return this.magicRoundTemp++,!1},isGameOver:function(){var t=this.aiFac.children,e=0;for(var i in t){var n=t[i].getComponent("flag").isGameOver(this.deadLine);2==n&&(e=2),1==n&&2!=e&&(e=1)}return 0==e?"ok":1==e?"warning":2==e?"gameover":void 0},stop:function(){this.isStoping=!0,this.resultCtl.getComponent("resultCtl").stop()},continue:function(){this.isStoping=!1,this.resultCtl.getComponent("resultCtl").continue()},return2index:function(){this.roundReady=!1,this.resultCtl.getComponent("resultCtl").return2Index()}}),cc._RF.pop()},{}],magic1:[function(t,e){"use strict";cc._RF.push(e,"1c163NwzCpLMZQHEE/TwFlC","magic1"),cc.Class({extends:cc.Component,properties:{},start:function(){},onBeginContact:function(t,e,i){i.getComponent("magic").copy(),this.node.destroy()}}),cc._RF.pop()},{}],magic:[function(t,e){"use strict";cc._RF.push(e,"02e83gR7OdOTIi2KlFdn+dk","magic"),cc.Class({extends:cc.Component,properties:{pool:{default:null,type:cc.Node},ballPre:{default:null,type:cc.Prefab},gameCtl:{default:null,type:cc.Node},used:!1},start:function(){},copy:function(){var t=cc.instantiate(this.ballPre);t.x=this.node.x,t.y=this.node.y,t.getComponent("magic").pool=this.pool,t.getComponent("magic").gameCtl=this.gameCtl;var e=3.14*Math.random()/3+3.14/3,i=600*Math.sin(e),n=600*Math.cos(e);t.getComponent(cc.RigidBody).linearVelocity=cc.v2(i,n),this.pool.addChild(t),this.gameCtl.getComponent("gameCtl").addBallNum()}}),cc._RF.pop()},{}],maskLoad:[function(t,e){"use strict";cc._RF.push(e,"09531PMsI9N0IkBB180ot+L","maskLoad"),cc.Class({extends:cc.Component,properties:{icon:{default:null,type:cc.Node}},start:function(){},update:function(){this.icon.rotation+=3,this.icon.rotation>360&&this.icon.rotation}}),cc._RF.pop()},{}],outwall:[function(t,e){"use strict";cc._RF.push(e,"d6e70tfbrtIzIoEwBMMvBSn","outwall"),cc.Class({extends:cc.Component,properties:{aiFac:{default:null,type:cc.Node}},start:function(){},onBeginContact:function(t,e,i){i.getComponent("magic").used||(i.getComponent("magic").used=!0,i.body.node.destroy(),this.aiFac.getComponent("gameCtl").moveBall(i.body.node.x,i.body.node.y))}}),cc._RF.pop()},{}],rankItem:[function(t,e){"use strict";cc._RF.push(e,"5b669aDsqZGLbiNhS1LZQNP","rankItem"),cc.Class({extends:cc.Component,properties:{rank:{default:null,type:cc.Label},user:{default:null,type:cc.Label},score:{default:null,type:cc.Label}},start:function(){},init:function(t,e,i){this.rank.string=null==t?"":t,this.user.string=null==e?"":e,this.score.string=null==i?"":i}}),cc._RF.pop()},{}],resultCtl:[function(t,e){"use strict";cc._RF.push(e,"96e25vAe9pGjLySPbtV6HEF","resultCtl"),cc.Class({extends:cc.Component,properties:{warning:{default:null,type:cc.Label},btns:{default:null,type:cc.Node},scoreShow:{default:null,type:cc.Node},mask:{default:null,type:cc.Node},scorePage:{default:null,type:cc.Node},title:{default:null,type:cc.Node},stopNode:{default:null,type:cc.Node},scoreReal:{default:null,type:cc.Label},scoreHighest:{default:null,type:cc.Label},itemRank:{default:null,type:cc.Prefab},selfRank:{default:null,type:cc.Node},cont:{default:null,type:cc.Node},leaderboard:{default:null,type:cc.Node},maskLoad:{default:null,type:cc.Node},hisScore:0,userName:"user",rank:0,rankName:"rank",itemY:-144,itemMargin:20,shareImg:"",shareWord:""},onLoad:function(){this.warning.node.active=!1,this.maskLoad.active=!1,this.scoreShow.active=!1,this.stopNode.active=!1,this.scorePage.active=!1,this.leaderboard.active=!1,this.getHistoryScore()},start:function(){},showWarninig:function(){this.warning.node.active=!0;var t=cc.fadeOut(.5),e=cc.fadeIn(.5),i=cc.fadeOut(.5),n=cc.sequence(t,e,i);this.warning.node.runAction(n)},startGame:function(){this.scorePage.active=!1,this.mask.active=!1,this.title.active=!1,this.btns.active=!1,this.scoreShow.active=!1,this.warning.node.active=!1,this.stopNode.active=!1},gameOver:function(t){this.stopNode.active=!1,this.scoreReal.string=t,t>this.hisScore&&(this.updateScore(t),this.hisScore=t),this.scoreHighest.string=this.hisScore,this.mask.active=!0,this.btns.active=!0,this.scoreShow.active=!0,this.scorePage.active=!0},stop:function(){this.btns.active||(this.mask.active=!0,this.stopNode.active=!0)},continue:function(){this.mask.active=!1,this.stopNode.active=!1},getHistoryScore:function(){try{var t=this;FBInstant.getLeaderboardAsync(this.rankName).then(function(t){return t.getPlayerEntryAsync()}).then(function(e){t.hisScore=e.getScore()})}catch(e){console.log("show history score error : "+e)}},updateScore:function(t){try{FBInstant.getLeaderboardAsync(this.rankName).then(function(e){return e.setScoreAsync(t)}).then(function(){})}catch(e){console.log("update history score error : "+e)}},getRankList:function(){var t=this;try{FBInstant.getLeaderboardAsync(this.rankName).then(function(t){return t.getEntriesAsync(100,0)}).then(function(e){t.initRankList(e),t.maskLoad.active=!1})}catch(e){console.log("getRankList error : "+e)}},initRankList:function(t){var e=-this.itemY+(this.itemRank.data.height+this.itemMargin)*t.length,i=this.cont.height;for(var n in e>i&&(this.cont.height=e),t)this.addItem(t[n].getRank(),t[n].getPlayer().getName(),t[n].getScore(),n)},addItem:function(t,e,i,n){var o=cc.instantiate(this.itemRank);o.getComponent("rankItem").init(t,e,i),o.setPosition(0,this.itemY-(this.itemRank.data.height+this.itemMargin)*n),this.cont.addChild(o)},showLeaderboard:function(){this.maskLoad.active=!0,this.leaderboard.active=!0;try{var t=this;FBInstant.getLeaderboardAsync(this.rankName).then(function(t){return t.getPlayerEntryAsync()}).then(function(e){t.hisScore=e.getScore(),t.userName=e.getPlayer().getName(),t.rank=e.getRank(),t.selfRank.getComponent("rankItem").init(t.rank,t.userName,t.hisScore),t.getRankList()})}catch(e){this.maskLoad.active=!1,console.log("show history score error : "+e)}},closeRankList:function(){this.maskLoad.active=!1,this.leaderboard.active=!1},test:function(){console.log("test")},shareRequest:function(){this.maskLoad.active=!0;var t=this;try{FBInstant.shareAsync({intent:"SHARE",image:t.shareImg,text:t.shareWord}).then(function(){t.maskLoad.active=!1})}catch(e){t.maskLoad.active=!1}},return2Index:function(){this.warning.node.active=!1,this.maskLoad.active=!1,this.scoreShow.active=!1,this.stopNode.active=!1,this.scorePage.active=!1,this.leaderboard.active=!1,this.mask.active=!0,this.btns.active=!0,this.title.active=!0}}),cc._RF.pop()},{}],scoreCtl:[function(t,e){"use strict";cc._RF.push(e,"961083FfwBAjrhuWTrMvhDt","scoreCtl"),cc.Class({extends:cc.Component,properties:{score:0},onLoad:function(){this.getComponent(cc.Label).string="score : 0"},start:function(){},initScore:function(){this.score=0,this.getComponent(cc.Label).string="score : "+this.score},addScore:function(){this.score++,this.getComponent(cc.Label).string="score : "+this.score},getScore:function(){return this.score}}),cc._RF.pop()},{}],underWall:[function(t,e){"use strict";cc._RF.push(e,"26a42ZsNglMlbhRqMXvt1a3","underWall"),cc.Class({extends:cc.Component,properties:{},start:function(){},onPreSolve:function(t,e,i){i.body.gravityScale=100}}),cc._RF.pop()},{}],"use_v2.0.x_cc.Toggle_event":[function(t,e){"use strict";cc._RF.push(e,"811181tXsdNj5QHsIPluW4v","use_v2.0.x_cc.Toggle_event"),cc.Toggle&&(cc.Toggle._triggerEventInScript_check=!0),cc._RF.pop()},{}],w:[function(t,e){"use strict";cc._RF.push(e,"1ff74Hs8mhKFbmAGMEeNyYR","w"),cc.Class({extends:cc.Component,properties:{},start:function(){},onBeginContact:function(t,e,i){i.body.gravityScale=3}}),cc._RF.pop()},{}]},{},["use_v2.0.x_cc.Toggle_event","ai","aiFactory","flag","gameCtl","magic","magic1","maskLoad","outwall","rankItem","resultCtl","scoreCtl","underWall","w"]);